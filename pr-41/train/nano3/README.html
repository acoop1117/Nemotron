

<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Nemotron 3 Nano Training Recipe &#8212; Nemotron</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/nvidia-sphinx-theme.css?v=933278ad" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/termynal.css?v=6e6caa80" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />



    <script src="../../_static/documentation_options.js?v=3ce10a4d"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.2.0/dist/mermaid-layout-elk.esm.min.mjs"></script>
    <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.2.0/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
    <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs";

const defaultStyle = document.createElement('style');
defaultStyle.textContent = `pre.mermaid {
    /* Same as .mermaid-container > pre */
    display: block;
    width: 100%;
}

pre.mermaid > svg {
    /* Same as .mermaid-container > pre > svg */
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}
`;
document.head.appendChild(defaultStyle);

const fullscreenStyle = document.createElement('style');
fullscreenStyle.textContent = `.mermaid-container {
    display: flex;
    flex-direction: row;
    width: 100%;
}

.mermaid-container > pre {
    display: block;
    width: 100%;
}

.mermaid-container > pre > svg {
    height: 500px;
    width: 100%;
    max-width: 100% !important;
}

.mermaid-fullscreen-btn {
    width: 28px;
    height: 28px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.3);
    border-radius: 4px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    font-size: 14px;
    line-height: 1;
    padding: 0;
    color: #333;
}

.mermaid-fullscreen-btn:hover {
    opacity: 100% !important;
    background: rgba(255, 255, 255, 1);
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
    transform: scale(1.1);
}

.mermaid-fullscreen-btn.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: #e0e0e0;
}

.mermaid-fullscreen-btn.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 3px 10px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal {
    display: none;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 95vw;
    height: 100vh;
    background: rgba(255, 255, 255, 0.98);
    z-index: 9999;
    padding: 20px;
    overflow: auto;
}

.mermaid-fullscreen-modal.dark-theme {
    background: rgba(0, 0, 0, 0.98);
}

.mermaid-fullscreen-modal.active {
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen {
    position: relative;
    width: 95vw;
    height: 90vh;
    max-width: 95vw;
    max-height: 90vh;
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    overflow: auto;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen.dark-theme {
    background: #1a1a1a;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
}

.mermaid-container-fullscreen pre.mermaid {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mermaid-container-fullscreen .mermaid svg {
    height: 100% !important;
    width: 100% !important;
    cursor: grab;
}

.mermaid-fullscreen-close {
    position: fixed !important;
    top: 20px !important;
    right: 20px !important;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(0, 0, 0, 0.2);
    border-radius: 50%;
    cursor: pointer;
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    transition: all 0.2s;
    font-size: 24px;
    line-height: 1;
    color: #333;
}

.mermaid-fullscreen-close:hover {
    background: white;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
    transform: scale(1.1);
}

.mermaid-fullscreen-close.dark-theme {
    background: rgba(50, 50, 50, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #e0e0e0;
}

.mermaid-fullscreen-close.dark-theme:hover {
    background: rgba(60, 60, 60, 1);
    box-shadow: 0 6px 16px rgba(255, 255, 255, 0.2);
}

.mermaid-fullscreen-modal .mermaid-fullscreen-btn {
    display: none !important;
}`;
document.head.appendChild(fullscreenStyle);

// Detect if page has dark background
const isDarkTheme = () => {
    const bgColor = window.getComputedStyle(document.body).backgroundColor;
    const match = bgColor.match(/rgb\((\d+),\s*(\d+),\s*(\d+)/);
    if (match) {
        const r = parseInt(match[1]);
        const g = parseInt(match[2]);
        const b = parseInt(match[3]);
        const brightness = (r * 299 + g * 587 + b * 114) / 1000;
        return brightness < 128;
    }
    return false;
};

const load = async () => {
    await mermaid.run();

    const all_mermaids = document.querySelectorAll(".mermaid");
    const mermaids_processed = document.querySelectorAll(".mermaid[data-processed='true']");

    if ("False" === "True") {
        const mermaids_to_add_zoom = -1 === -1 ? all_mermaids.length : -1;
        if(mermaids_to_add_zoom > 0) {
            var svgs = d3.selectAll("");
            if(all_mermaids.length !== mermaids_processed.length) {
                setTimeout(load, 200);
                return;
            } else if(svgs.size() !== mermaids_to_add_zoom) {
                setTimeout(load, 200);
                return;
            } else {
                svgs.each(function() {
                    var svg = d3.select(this);
                    svg.html("<g class='wrapper'>" + svg.html() + "</g>");
                    var inner = svg.select("g");
                    var zoom = d3.zoom().on("zoom", function(event) {
                        inner.attr("transform", event.transform);
                    });
                    svg.call(zoom);
                });
            }
        }
    } else if(all_mermaids.length !== mermaids_processed.length) {
        // Wait for mermaid to process all diagrams
        setTimeout(load, 200);
        return;
    }

    const darkTheme = isDarkTheme();

    // Stop here if not adding fullscreen capability
    if ("True" !== "True") return;

    const modal = document.createElement('div');
    modal.className = 'mermaid-fullscreen-modal' + (darkTheme ? ' dark-theme' : '');
    modal.setAttribute('role', 'dialog');
    modal.setAttribute('aria-modal', 'true');
    modal.setAttribute('aria-label', 'Fullscreen diagram viewer');
    modal.innerHTML = `
        <button class="mermaid-fullscreen-close${darkTheme ? ' dark-theme' : ''}" aria-label="Close fullscreen">✕</button>
        <div class="mermaid-container-fullscreen${darkTheme ? ' dark-theme' : ''}"></div>
    `;
    document.body.appendChild(modal);

    const modalContent = modal.querySelector('.mermaid-container-fullscreen');
    const closeBtn = modal.querySelector('.mermaid-fullscreen-close');

    let previousScrollOffset = [window.scrollX, window.scrollY];

    const closeModal = () => {
        modal.classList.remove('active');
        modalContent.innerHTML = '';
        document.body.style.overflow = ''
        window.scrollTo({left: previousScrollOffset[0], top: previousScrollOffset[1], behavior: 'instant'});
    };

    closeBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', (e) => {
        if (e.target === modal) closeModal();
    });
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('active')) {
            closeModal();
        }
    });

    const allButtons = [];

    document.querySelectorAll('.mermaid').forEach((mermaidDiv) => {
        if (mermaidDiv.parentNode.classList.contains('mermaid-container') ||
            mermaidDiv.closest('.mermaid-fullscreen-modal')) {
            return;
        }

        const container = document.createElement('div');
        container.className = 'mermaid-container';
        mermaidDiv.parentNode.insertBefore(container, mermaidDiv);
        container.appendChild(mermaidDiv);

        const fullscreenBtn = document.createElement('button');
        fullscreenBtn.className = 'mermaid-fullscreen-btn' + (darkTheme ? ' dark-theme' : '');
        fullscreenBtn.setAttribute('aria-label', 'View diagram in fullscreen');
        fullscreenBtn.textContent = '⛶';
        fullscreenBtn.style.opacity = '50%';

        // Calculate dynamic position based on diagram's margin and padding
        const diagramStyle = window.getComputedStyle(mermaidDiv);
        const marginTop = parseFloat(diagramStyle.marginTop) || 0;
        const marginRight = parseFloat(diagramStyle.marginRight) || 0;
        const paddingTop = parseFloat(diagramStyle.paddingTop) || 0;
        const paddingRight = parseFloat(diagramStyle.paddingRight) || 0;
        fullscreenBtn.style.top = `${marginTop + paddingTop + 4}px`;
        fullscreenBtn.style.right = `${marginRight + paddingRight + 4}px`;

        fullscreenBtn.addEventListener('click', () => {
            previousScrollOffset = [window.scroll, window.scrollY];
            const clone = mermaidDiv.cloneNode(true);
            modalContent.innerHTML = '';
            modalContent.appendChild(clone);

            const svg = clone.querySelector('svg');
            if (svg) {
                svg.removeAttribute('width');
                svg.removeAttribute('height');
                svg.style.width = '100%';
                svg.style.height = 'auto';
                svg.style.maxWidth = '100%';
                svg.style.sdisplay = 'block';

                if ("False" === "True") {
                    setTimeout(() => {
                        const g = svg.querySelector('g');
                        if (g) {
                            var svgD3 = d3.select(svg);
                            svgD3.html("<g class='wrapper'>" + svgD3.html() + "</g>");
                            var inner = svgD3.select("g");
                            var zoom = d3.zoom().on("zoom", function(event) {
                                inner.attr("transform", event.transform);
                            });
                            svgD3.call(zoom);
                        }
                    }, 100);
                }
            }

            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });

        container.appendChild(fullscreenBtn);
        allButtons.push(fullscreenBtn);
    });

    // Update theme classes when theme changes
    const updateTheme = () => {
        const dark = isDarkTheme();
        allButtons.forEach(btn => {
            if (dark) {
                btn.classList.add('dark-theme');
            } else {
                btn.classList.remove('dark-theme');
            }
        });
        if (dark) {
            modal.classList.add('dark-theme');
            modalContent.classList.add('dark-theme');
            closeBtn.classList.add('dark-theme');
        } else {
            modal.classList.remove('dark-theme');
            modalContent.classList.remove('dark-theme');
            closeBtn.classList.remove('dark-theme');
        }
    };

    // Watch for theme changes
    const observer = new MutationObserver(updateTheme);
    observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['class', 'style', 'data-theme']
    });
    observer.observe(document.body, {
        attributes: true,
        attributeFilter: ['class', 'style']
    });
};

window.addEventListener("load", load);
</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'train/nano3/README';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://nvidia-nemo.github.io/Nemotron/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <script src="../../_static/js/termynal.js?v=05ab89e6"></script>
    <script src="../../_static/js/termynal-init.js?v=7fa8cdf6"></script>

    <link rel="icon" href="../../_static/favicon.png"/>

    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Artifact Lineage &amp; W&amp;B Integration" href="../artifacts.html" />
    <link rel="prev" title="RAG Agent with Nemotron RAG Models" href="../../use-case-examples/RAG%20Agent%20with%20Nemotron%20RAG%20Models/README.html" />


  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />


    <script src="https://assets.adobedtm.com/5d4962a43b79/c1061d2c5e7b/launch-191c2462b890.min.js" ></script>
    


  </head>

  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>


  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="Nemotron - Home"/>
    <img src="../../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="Nemotron - Home"/>
  
  
    <p class="title logo__title">Nemotron</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">


<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NVIDIA/nemotron" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        



  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="Nemotron - Home"/>
    <img src="../../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="Nemotron - Home"/>
  
  
    <p class="title logo__title">Nemotron</p>
  
</a>


  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">


<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NVIDIA/nemotron" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">



<nav class="bd-docs-nav bd-links"
     aria-label="Table of Contents">
  <p class="bd-links__title" role="heading" aria-level="1">Table of Contents</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Usage Cookbook</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../usage-cookbook/README.html">Usage Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage-cookbook/Nemotron-Nano2-VL/README.html">Nemotron-Nano2-VL Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage-cookbook/Nemotron-Parse-v1.1/README.html">Nemotron-Parse-v1.1 Notebooks</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Use Case Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../use-case-examples/README.html">Nemotron Use Case Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../use-case-examples/Simple%20Nemotron-3-Nano%20Usage%20Example/README.html">NVIDIA Nemotron 3 Nano - Simple Usage Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../use-case-examples/Data%20Science%20ML%20Agent/README.html">Data Science ML Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../use-case-examples/RAG%20Agent%20with%20Nemotron%20RAG%20Models/README.html">RAG Agent with Nemotron RAG Models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Training Recipes</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Nemotron 3 Nano Training Recipe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../artifacts.html">Artifact Lineage &amp; W&amp;B Integration</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Nano3 Stages</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pretrain.html">Stage 0: Pretraining</a></li>
<li class="toctree-l1"><a class="reference internal" href="sft.html">Stage 1: Supervised Fine-Tuning (SFT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="rl.html">Stage 2: Reinforcement Learning (RL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="import.html">Importing Models and Data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Nemotron Kit</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../kit.html">Nemotron Kit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nvidia-stack.html">NVIDIA AI Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nemo-run.html">Execution through NeMo-Run</a></li>
<li class="toctree-l1"><a class="reference internal" href="../omegaconf.html">OmegaConf Configuration System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wandb.html">Weights &amp; Biases Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">CLI Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-prep.html">Data Preparation Module</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>



      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Nemotron 3 Nano Training Recipe</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="nemotron-3-nano-training-recipe">
<h1>Nemotron 3 Nano Training Recipe<a class="headerlink" href="#nemotron-3-nano-training-recipe" title="Link to this heading">#</a></h1>
<p>A complete, reproducible training pipeline for Nemotron 3 Nano—an open, efficient Mixture-of-Experts hybrid Mamba-Transformer model optimized for agentic reasoning.</p>
<section id="quick-start">
<h2>Quick Start<a class="headerlink" href="#quick-start" title="Link to this heading">#</a></h2>
<section id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Slurm cluster</strong> with GPU nodes (H100 recommended) — see <a class="reference internal" href="../nemo-run.html"><span class="std std-doc">Execution through NeMo-Run</span></a></p></li>
<li><p><strong><a class="reference internal" href="../wandb.html"><span class="std std-doc">Weights &amp; Biases</span></a> account</strong> for experiment tracking and <a class="reference internal" href="../artifacts.html"><span class="std std-doc">artifact lineage</span></a></p></li>
<li><p><strong>Container images</strong>:</p>
<ul>
<li><p>Training: <code class="docutils literal notranslate"><span class="pre">nvcr.io/nvidia/nemo:25.11.nemotron_3_nano</span></code></p></li>
<li><p>RL: <code class="docutils literal notranslate"><span class="pre">nvcr.io/nvidia/nemo-rl:v0.4.0.nemotron_3_nano</span></code></p></li>
</ul>
</li>
</ul>
</section>
<section id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Link to this heading">#</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/NVIDIA/nemotron
<span class="nb">cd</span><span class="w"> </span>nemotron
uv<span class="w"> </span>sync
</pre></div>
</div>
</section>
<section id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">#</a></h3>
<p>Create an <code class="docutils literal notranslate"><span class="pre">env.toml</span></code> file (see <a class="reference internal" href="../nemo-run.html"><span class="std std-doc">Execution through NeMo-Run</span></a> for details):</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[wandb]</span>
<span class="n">project</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;nemotron&quot;</span>
<span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;YOUR-TEAM&quot;</span>

<span class="k">[YOUR-CLUSTER]</span>
<span class="n">executor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;slurm&quot;</span>
<span class="n">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;YOUR-ACCOUNT&quot;</span>
<span class="n">partition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;batch&quot;</span>
<span class="n">nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="n">ntasks_per_node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span>
<span class="n">gpus_per_node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span>
<span class="n">mounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;/lustre:/lustre&quot;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="run-the-pipeline">
<h3>Run the Pipeline<a class="headerlink" href="#run-the-pipeline" title="Link to this heading">#</a></h3>
<div class="termy">
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">// Stage 0: Pretraining</span>
<span class="gp">$ </span>uv<span class="w"> </span>run<span class="w"> </span>nemotron<span class="w"> </span>nano3<span class="w"> </span>data<span class="w"> </span>prep<span class="w"> </span>pretrain<span class="w"> </span>--run<span class="w"> </span>YOUR-CLUSTER
<span class="gp">$ </span>uv<span class="w"> </span>run<span class="w"> </span>nemotron<span class="w"> </span>nano3<span class="w"> </span>pretrain<span class="w"> </span>--run<span class="w"> </span>YOUR-CLUSTER

<span class="go">// Stage 1: Supervised Fine-Tuning</span>
<span class="gp">$ </span>uv<span class="w"> </span>run<span class="w"> </span>nemotron<span class="w"> </span>nano3<span class="w"> </span>data<span class="w"> </span>prep<span class="w"> </span>sft<span class="w"> </span>--run<span class="w"> </span>YOUR-CLUSTER
<span class="gp">$ </span>uv<span class="w"> </span>run<span class="w"> </span>nemotron<span class="w"> </span>nano3<span class="w"> </span>sft<span class="w"> </span>--run<span class="w"> </span>YOUR-CLUSTER

<span class="go">// Stage 2: Reinforcement Learning</span>
<span class="gp">$ </span>uv<span class="w"> </span>run<span class="w"> </span>nemotron<span class="w"> </span>nano3<span class="w"> </span>data<span class="w"> </span>prep<span class="w"> </span>rl<span class="w"> </span>--run<span class="w"> </span>YOUR-CLUSTER
<span class="gp">$ </span>uv<span class="w"> </span>run<span class="w"> </span>nemotron<span class="w"> </span>nano3<span class="w"> </span>rl<span class="w"> </span>--run<span class="w"> </span>YOUR-CLUSTER
</pre></div>
</div>
</div>
</section>
</section>
<section id="resources">
<h2>Resources<a class="headerlink" href="#resources" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Tech Report</strong>: <a class="reference external" href="https://research.nvidia.com/labs/nemotron/files/NVIDIA-Nemotron-3-Nano-Technical-Report.pdf">Nemotron 3 Nano Technical Report</a></p></li>
<li><p><strong>Model Weights</strong>:</p>
<ul>
<li><p><a class="reference external" href="https://huggingface.co/nvidia/NVIDIA-Nemotron-3-Nano-30B-A3B-Base-BF16">NVIDIA-Nemotron-3-Nano-30B-A3B-Base-BF16</a> (Base model)</p></li>
<li><p><a class="reference external" href="https://huggingface.co/nvidia/NVIDIA-Nemotron-3-Nano-30B-A3B-BF16">NVIDIA-Nemotron-3-Nano-30B-A3B-BF16</a> (Instruct model)</p></li>
<li><p><a class="reference external" href="https://huggingface.co/nvidia/NVIDIA-Nemotron-3-Nano-30B-A3B-FP8">NVIDIA-Nemotron-3-Nano-30B-A3B-FP8</a> (FP8 quantized)</p></li>
</ul>
</li>
<li><p><strong>Model Collection</strong>: <a class="reference external" href="https://huggingface.co/collections/nvidia/nvidia-nemotron-v3">NVIDIA Nemotron v3 Collection</a></p></li>
<li><p><strong>Training Datasets</strong>:</p>
<ul>
<li><p><a class="reference external" href="https://huggingface.co/collections/nvidia/nemotron-pre-training-datasets">Pre-training Datasets</a> (Open pre-training data)</p></li>
<li><p><a class="reference external" href="https://huggingface.co/collections/nvidia/nemotron-post-training-v3">Post-training Datasets</a> (SFT and RL data)</p></li>
</ul>
</li>
</ul>
</section>
<section id="training-pipeline">
<h2>Training Pipeline<a class="headerlink" href="#training-pipeline" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Stage</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Purpose</p></th>
<th class="head"><p>Guide</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p><a class="reference internal" href="pretrain.html"><span class="std std-doc">Pretraining</span></a></p></td>
<td><p>Base model on 25T tokens with curriculum learning</p></td>
<td><p><a class="reference internal" href="pretrain.html"><span class="std std-doc">pretrain.md</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p><a class="reference internal" href="sft.html"><span class="std std-doc">SFT</span></a></p></td>
<td><p>Multi-domain instruction tuning with 12+ data sources</p></td>
<td><p><a class="reference internal" href="sft.html"><span class="std std-doc">sft.md</span></a></p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p><a class="reference internal" href="rl.html"><span class="std std-doc">RL</span></a></p></td>
<td><p>GRPO alignment with multi-environment rewards</p></td>
<td><p><a class="reference internal" href="rl.html"><span class="std std-doc">rl.md</span></a></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="model-specifications">
<h2>Model Specifications<a class="headerlink" href="#model-specifications" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Specification</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Total Parameters</strong></p></td>
<td><p>31.6B</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Active Parameters</strong></p></td>
<td><p>3.6B (per forward pass)</p></td>
</tr>
<tr class="row-even"><td><p><strong>Pretraining Tokens</strong></p></td>
<td><p>25 trillion</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Context Length</strong></p></td>
<td><p>Up to 1M tokens</p></td>
</tr>
<tr class="row-even"><td><p><strong>Architecture</strong></p></td>
<td><p>Hybrid Mamba-Transformer with sparse MoE</p></td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<div><p>For architecture details, see <a class="reference external" href="https://research.nvidia.com/labs/nemotron/files/NVIDIA-Nemotron-3-Nano-Technical-Report.pdf">Tech Report Section 2.1</a>.</p>
</div></blockquote>
</section>
<section id="stage-summaries">
<h2>Stage Summaries<a class="headerlink" href="#stage-summaries" title="Link to this heading">#</a></h2>
<section id="stage-0-pretraining">
<h3>Stage 0: Pretraining<a class="headerlink" href="#stage-0-pretraining" title="Link to this heading">#</a></h3>
<p>Two-phase curriculum on 25 trillion tokens: Phase 1 (23.5T) focuses on diversity across web, code, math, and multilingual data; Phase 2 (1.5T) emphasizes high-quality sources. Includes long-context extension to 1M tokens.</p>
<p>→ <a class="reference internal" href="pretrain.html"><span class="std std-doc">Pretraining Guide</span></a></p>
</section>
<section id="stage-1-supervised-fine-tuning">
<h3>Stage 1: Supervised Fine-Tuning<a class="headerlink" href="#stage-1-supervised-fine-tuning" title="Link to this heading">#</a></h3>
<p>Multi-domain instruction tuning covering 12+ data domains including competition math/code, InfinityByte cross-domain synthesis, STEM reasoning, conversational tool use, and multilingual support.</p>
<p>→ <a class="reference internal" href="sft.html"><span class="std std-doc">SFT Guide</span></a></p>
</section>
<section id="stage-2-reinforcement-learning">
<h3>Stage 2: Reinforcement Learning<a class="headerlink" href="#stage-2-reinforcement-learning" title="Link to this heading">#</a></h3>
<p>Multi-environment RLVR training across 7 reward environments using GRPO, plus GenRM-based RLHF and DPO for reducing tool hallucination.</p>
<p>→ <a class="reference internal" href="rl.html"><span class="std std-doc">RL Guide</span></a></p>
</section>
</section>
<section id="execution-options">
<h2>Execution Options<a class="headerlink" href="#execution-options" title="Link to this heading">#</a></h2>
<p>All commands support <a class="reference internal" href="../nemo-run.html"><span class="std std-doc">NeMo-Run</span></a> execution modes:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Behavior</p></th>
<th class="head"><p>Use Case</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--run</span> <span class="pre">&lt;profile&gt;</span></code></p></td>
<td><p>Attached—submits job and streams logs</p></td>
<td><p>Interactive development</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--batch</span> <span class="pre">&lt;profile&gt;</span></code></p></td>
<td><p>Detached—submits and exits immediately</p></td>
<td><p>Long-running jobs</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--dry-run</span></code></p></td>
<td><p>Preview execution plan</p></td>
<td><p>Validation</p></td>
</tr>
</tbody>
</table>
</div>
<p>See <a class="reference internal" href="../nemo-run.html"><span class="std std-doc">Execution through NeMo-Run</span></a> for profile configuration and advanced options.</p>
</section>
<section id="artifact-lineage">
<h2>Artifact Lineage<a class="headerlink" href="#artifact-lineage" title="Link to this heading">#</a></h2>
<p>The pipeline tracks full lineage via <a class="reference internal" href="../artifacts.html"><span class="std std-doc">W&amp;B Artifacts</span></a>, enabling traceability from raw data to final model.</p>
<pre  class="mermaid">
        %%{init: {'theme': 'base', 'themeVariables': { 'primaryBorderColor': '#333333', 'lineColor': '#333333', 'primaryTextColor': '#333333', 'clusterBkg': '#ffffff', 'clusterBorder': '#333333'}}}%%
flowchart TB
    subgraph pretrain[&quot;Stage 0: Pretraining&quot;]
        raw[&quot;Raw Text Data&quot;] --&gt; data0[&quot;DataBlendsArtifact-pretrain&lt;br/&gt;(bin/idx)&quot;]
        data0 --&gt; cmd0[&quot;uv run nemotron nano3 pretrain&quot;]
        cmd0 --&gt; model0[&quot;ModelArtifact-pretrain&quot;]
    end

    subgraph sft[&quot;Stage 1: SFT&quot;]
        data1[&quot;DataBlendsArtifact-sft&lt;br/&gt;(.npy)&quot;] --&gt; cmd1[&quot;uv run nemotron nano3 sft&quot;]
        model0 --&gt; cmd1
        cmd1 --&gt; model1[&quot;ModelArtifact-sft&quot;]
    end

    subgraph rl[&quot;Stage 2: RL&quot;]
        data2[&quot;DataBlendsArtifact-rl&lt;br/&gt;(JSONL)&quot;] --&gt; cmd2[&quot;uv run nemotron nano3 rl&quot;]
        model1 --&gt; cmd2
        cmd2 --&gt; model2[&quot;ModelArtifact-rl&lt;br/&gt;(Final Model)&quot;]
    end

    style pretrain fill:#e1f5fe,stroke:#2196f3
    style sft fill:#f3e5f5,stroke:#9c27b0
    style rl fill:#e8f5e9,stroke:#4caf50
    </pre><p>→ <a class="reference internal" href="../artifacts.html"><span class="std std-doc">Artifact Lineage &amp; W&amp;B Integration</span></a></p>
</section>
<section id="open-source-data">
<h2>Open-Source Data<a class="headerlink" href="#open-source-data" title="Link to this heading">#</a></h2>
<blockquote>
<div><p><strong>Note</strong>: These recipes train exclusively on the open-sourced subset of training data. Results will differ from the tech report benchmarks, which used additional proprietary data. Use these recipes as reference implementations to apply the methodology with your own data.</p>
</div></blockquote>
</section>
<section id="coming-soon">
<h2>Coming Soon<a class="headerlink" href="#coming-soon" title="Link to this heading">#</a></h2>
<p>Native integrations with NVIDIA’s NeMo ecosystem:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Tool</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Status</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/NVIDIA-NeMo/Curator">NeMo Curator</a></p></td>
<td><p>Scalable data curation—deduplication, quality filtering, PII removal</p></td>
<td><p>Planned</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/NVIDIA-NeMo/DataDesigner">NeMo Data Designer</a></p></td>
<td><p>Synthetic data generation for instruction tuning and alignment</p></td>
<td><p>Planned</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/NVIDIA-NeMo/Export-Deploy">NeMo Export-Deploy</a></p></td>
<td><p>Model export to TensorRT-LLM and deployment</p></td>
<td><p>Planned</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/NVIDIA-NeMo/Evaluator">NeMo Evaluator</a></p></td>
<td><p>Comprehensive model evaluation and benchmarking</p></td>
<td><p>Planned</p></td>
</tr>
</tbody>
</table>
</div>
<p>These integrations will enable end-to-end pipelines from data curation to model evaluation.</p>
</section>
<section id="cli-reference">
<h2>CLI Reference<a class="headerlink" href="#cli-reference" title="Link to this heading">#</a></h2>
<div class="termy">
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">// Show available commands</span>
<span class="gp">$ </span>uv<span class="w"> </span>run<span class="w"> </span>nemotron<span class="w"> </span>nano3<span class="w"> </span>--help
<span class="go">Usage: nemotron nano3 [OPTIONS] COMMAND [ARGS]...</span>

<span class="go"> Nano3 training recipe</span>

<span class="go">╭─ Commands ───────────────────────────────────────────────────────────────╮</span>
<span class="go">│ data       Data curation and preparation commands                        │</span>
<span class="go">│ model      Model evaluation and import commands                          │</span>
<span class="go">╰──────────────────────────────────────────────────────────────────────────╯</span>
<span class="go">╭─ Training Stages ────────────────────────────────────────────────────────╮</span>
<span class="go">│ pretrain   Run pretraining with Megatron-Bridge (stage0).                │</span>
<span class="go">│ sft        Run supervised fine-tuning with Megatron-Bridge (stage1).     │</span>
<span class="go">│ rl         Run reinforcement learning with NeMo-RL GRPO (stage2).        │</span>
<span class="go">╰──────────────────────────────────────────────────────────────────────────╯</span>

<span class="go">// View training command help (SFT example with artifact overrides)</span>
<span class="gp">$ </span>uv<span class="w"> </span>run<span class="w"> </span>nemotron<span class="w"> </span>nano3<span class="w"> </span>sft<span class="w"> </span>--help
<span class="go">Usage: nemotron nano3 sft [OPTIONS]</span>

<span class="go"> Run supervised fine-tuning with Megatron-Bridge (stage1).</span>

<span class="go">╭─ Options ────────────────────────────────────────────────────────────────╮</span>
<span class="go">│ --help  -h        Show this message and exit.                            │</span>
<span class="go">╰──────────────────────────────────────────────────────────────────────────╯</span>
<span class="go">╭─ Global Options ─────────────────────────────────────────────────────────╮</span>
<span class="go">│  -c, --config NAME       Config name or path                             │</span>
<span class="go">│  -r, --run PROFILE       Submit to cluster (attached)                    │</span>
<span class="go">│  -b, --batch PROFILE     Submit to cluster (detached)                    │</span>
<span class="go">│  -d, --dry-run           Preview config without execution                │</span>
<span class="go">│  --stage                 Stage files for interactive debugging           │</span>
<span class="go">╰──────────────────────────────────────────────────────────────────────────╯</span>
<span class="go">╭─ Configs (-c/--config) ──────────────────────────────────────────────────╮</span>
<span class="go">│ Built-in: default, tiny                                                  │</span>
<span class="go">│ Custom: -c /path/to/your/config.yaml                                     │</span>
<span class="go">╰──────────────────────────────────────────────────────────────────────────╯</span>
<span class="go">╭─ Artifact Overrides (W&amp;B artifact references) ───────────────────────────╮</span>
<span class="go">│  run.model     Base model checkpoint artifact                            │</span>
<span class="go">│  run.data      SFT data artifact (packed .npy)                           │</span>
<span class="go">╰──────────────────────────────────────────────────────────────────────────╯</span>
<span class="go">╭─ Run Overrides (override env.toml settings) ─────────────────────────────╮</span>
<span class="go">│  run.env.nodes               Number of nodes                             │</span>
<span class="go">│  run.env.nproc_per_node      GPUs per node                               │</span>
<span class="go">│  run.env.partition           Slurm partition                             │</span>
<span class="go">│  run.env.account             Slurm account                               │</span>
<span class="go">│  run.env.time                Job time limit (e.g., 04:00:00)             │</span>
<span class="go">│  run.env.container_image     Override container image                    │</span>
<span class="go">╰──────────────────────────────────────────────────────────────────────────╯</span>
<span class="go">╭─ env.toml Profiles ──────────────────────────────────────────────────────╮</span>
<span class="go">│ Available profiles: YOUR-CLUSTER, YOUR-CLUSTER-large                     │</span>
<span class="go">│ Usage: --run PROFILE or --batch PROFILE                                  │</span>
<span class="go">╰──────────────────────────────────────────────────────────────────────────╯</span>
<span class="go">╭─ Examples ───────────────────────────────────────────────────────────────╮</span>
<span class="go">│ $ ... sft -c tiny                    Local execution                     │</span>
<span class="go">│ $ ... sft -c tiny --dry-run          Preview config                      │</span>
<span class="go">│ $ ... sft -c tiny --run my-cluster   Submit to cluster                   │</span>
<span class="go">│ $ ... sft -c tiny -r cluster run.env.nodes=4                             │</span>
<span class="go">╰──────────────────────────────────────────────────────────────────────────╯</span>
</pre></div>
</div>
</div>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading">#</a></h2>
<p><strong>W&amp;B authentication</strong>: See <a class="reference internal" href="../wandb.html"><span class="std std-doc">W&amp;B Integration</span></a> for setup.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wandb<span class="w"> </span>login
</pre></div>
</div>
<p><strong>Container not found</strong>: Verify image path in config files.</p>
<p><strong>Job submission fails</strong>: Check Slurm account and partition in <code class="docutils literal notranslate"><span class="pre">env.toml</span></code>. See <a class="reference internal" href="../nemo-run.html"><span class="std std-doc">Execution through NeMo-Run</span></a>.</p>
</section>
<section id="further-reading">
<h2>Further Reading<a class="headerlink" href="#further-reading" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="pretrain.html"><span class="std std-doc">Stage 0: Pretraining</span></a></p></li>
<li><p><a class="reference internal" href="sft.html"><span class="std std-doc">Stage 1: SFT</span></a></p></li>
<li><p><a class="reference internal" href="rl.html"><span class="std std-doc">Stage 2: RL</span></a></p></li>
<li><p><a class="reference internal" href="import.html"><span class="std std-doc">Importing Models &amp; Data</span></a></p></li>
<li><p><a class="reference internal" href="../artifacts.html"><span class="std std-doc">Artifact Lineage</span></a></p></li>
<li><p><a class="reference internal" href="../nemo-run.html"><span class="std std-doc">Execution through NeMo-Run</span></a></p></li>
<li><p><a class="reference internal" href="../wandb.html"><span class="std std-doc">W&amp;B Integration</span></a></p></li>
<li><p><a class="reference internal" href="../nvidia-stack.html"><span class="std std-doc">NVIDIA AI Stack</span></a></p></li>
<li><p><a class="reference internal" href="../cli.html"><span class="std std-doc">CLI Framework</span></a></p></li>
<li><p><a class="reference internal" href="../data-prep.html"><span class="std std-doc">Data Preparation Module</span></a></p></li>
</ul>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../use-case-examples/RAG%20Agent%20with%20Nemotron%20RAG%20Models/README.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">RAG Agent with Nemotron RAG Models</p>
      </div>
    </a>
    <a class="right-next"
       href="../artifacts.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Artifact Lineage &amp; W&amp;B Integration</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            


              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-start">Quick Start</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#installation">Installation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration">Configuration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-pipeline">Run the Pipeline</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resources">Resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-pipeline">Training Pipeline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-specifications">Model Specifications</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stage-summaries">Stage Summaries</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stage-0-pretraining">Stage 0: Pretraining</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stage-1-supervised-fine-tuning">Stage 1: Supervised Fine-Tuning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stage-2-reinforcement-learning">Stage 2: Reinforcement Learning</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#execution-options">Execution Options</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#artifact-lineage">Artifact Lineage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#open-source-data">Open-Source Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coming-soon">Coming Soon</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cli-reference">CLI Reference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#troubleshooting">Troubleshooting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">Further Reading</a></li>
</ul>
  </nav></div>

</div></div>
              
            

          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  

  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>


  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
<a class="footer-brand logo" href="https://www.nvidia.com">
  <img src="../../_static/nvidia-logo-horiz-rgb-1c-blk-for-screen.svg" class="logo__image only-light" alt="NVIDIA"/>
  <img src="../../_static/nvidia-logo-horiz-rgb-1c-wht-for-screen.svg" class="logo__image only-dark" alt="NVIDIA"/>
</a></div>
      
        <div class="footer-item">

<div class="footer-links">
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/privacy-policy/">Privacy Policy</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/privacy-center/">Your Privacy Choices</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/terms-of-service/">Terms of Service</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/accessibility/">Accessibility</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/company-policies/">Corporate Policies</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/product-security/">Product Security</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/contact/">Contact</a>
  
  
  
</div>
</div>
      
        <div class="footer-item">




  <p class="copyright">
    
      Copyright © 2025, NVIDIA Corporation.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
<div class="extra_footer">
  
  
    <script type="text/javascript">if (typeof _satellite !== "undefined") {_satellite.pageBottom();}</script>
    
  
</div></div>
      
    </div>
  
  
  
</div>

  </footer>
  </body>
</html>